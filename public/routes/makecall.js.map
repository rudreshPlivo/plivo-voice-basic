{"version":3,"sources":["../../src/routes/makecall.js"],"names":["plivo","router","express","Router","post","req","res","next","console","log","JSON","stringify","body","callData","toNumber","fromNumber","answerUrl","client","Client","env","AUTH_ID","AUTH_TOKEN","calls","create","then","response","json","msg","catch","err","error"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;IAAYA,K;;;;;;AAEZ,IAAMC,SAASC,kBAAQC,MAAR,EAAf;;AAEAF,OAAOG,IAAP,CAAY,GAAZ,EAAgB,UAACC,GAAD,EAAKC,GAAL,EAASC,IAAT,EAAkB;AAC9B;AACAC,YAAQC,GAAR,CAAYC,KAAKC,SAAL,CAAeN,IAAIO,IAAnB,CAAZ;;AAEA,QAAIC,WAAWH,KAAKC,SAAL,CAAeN,IAAIO,IAAnB,CAAf;AACAJ,YAAQC,GAAR,kBAA2BI,QAA3B;AACA,QAAIC,WAAWD,SAASC,QAAxB;AACA,QAAIC,aAAaF,SAASE,UAA1B;AACA,QAAIC,oDAAJ;;AAEA,QAAI;AACAR,gBAAQC,GAAR;AACA,YAAIQ,SAAS,IAAIjB,MAAMkB,MAAV,CAAiBC,cAAIC,OAArB,EAA6BD,cAAIE,UAAjC,CAAb;AACAJ,eAAOK,KAAP,CAAaC,MAAb,CACIR,UADJ,EAEID,QAFJ,EAGIE,SAHJ,EAKCQ,IALD,CAKM,UAACC,QAAD,EAAc;AAChBjB,oBAAQC,GAAR,wCAAiDgB,QAAjD;AACAnB,gBAAIoB,IAAJ,CAAS;AACLC,qBAAK;AADA,aAAT;AAGH,SAVD,EAWCC,KAXD,CAWO,UAACC,GAAD,EAAS;AACZrB,oBAAQC,GAAR,wCAAiDoB,GAAjD;AACAvB,gBAAIoB,IAAJ,CAAS;AACLI,uBAAOD;AADF,aAAT;AAGH,SAhBD;AAiBH,KApBD,CAoBE,OAAOC,KAAP,EAAc;AACZtB,gBAAQC,GAAR,yBAAkCqB,KAAlC;AACAvB,aAAKuB,KAAL;AACH;AAEJ,CAnCD;;kBAqCe7B,M","file":"makecall.js","sourcesContent":["import express from \"express\";\nimport env from \"./../config/env\";\nimport * as plivo from \"plivo\";\n\nconst router = express.Router();\n\nrouter.post('/',(req,res,next) => {\n    //call api\n    console.log(JSON.stringify(req.body));\n    \n    var callData = JSON.stringify(req.body);\n    console.log(`calldata is ${callData}`);\n    var toNumber = callData.toNumber;\n    var fromNumber = callData.fromNumber;\n    var answerUrl = `https://pl-voice.herokuapp.com/playurl`;\n\n    try {\n        console.log(`invoking plivo api`);\n        var client = new plivo.Client(env.AUTH_ID,env.AUTH_TOKEN);\n        client.calls.create(\n            fromNumber,\n            toNumber,\n            answerUrl\n        )\n        .then((response) => {\n            console.log(`Success: response from plivo is - ${response}`);\n            res.json({\n                msg: \"call initiated\"\n            });\n        })\n        .catch((err) => {\n            console.log(`something went wrong with plivo - ${err}`);\n            res.json({\n                error: err\n            });\n        });\n    } catch (error) {\n        console.log(`that didnt work  - ${error}`);\n        next(error);\n    }\n\n});\n\nexport default router;"]}